import{i,u as k,r as f,j as m}from"./index.5597beed.js";const h=i("Auth",()=>{const r=k(),s=f(),o=m(()=>({cellphone:"09123456789",name:"Ali",exp:Date.now()+30*60*1e3}));function c(e){s.value=e,sessionStorage.setItem("access-token",e.accessToken),sessionStorage.setItem("refresh-token",e.refreshToken)}function a(){s.value={accessToken:sessionStorage.getItem("access-token"),refreshToken:sessionStorage.getItem("refresh-token")}}function u(){var e,n;!!sessionStorage.getItem("access-token")&&!!sessionStorage.getItem("refresh-token")?(a(),((e=o.value)==null?void 0:e.exp)&&((n=o.value)==null?void 0:n.exp)*1e3<Date.now()&&t()):t()}async function t(){s.value=null,sessionStorage.removeItem("access-token"),sessionStorage.removeItem("refresh-token"),r.push({name:"login"})}return{token:s,user:o,setToken:c,checkAuth:u,logout:t}});export{h as u};
